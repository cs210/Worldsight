{"ast":null,"code":"import _regeneratorRuntime from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _getPrototypeOf from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _get from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _inherits from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/aakankshasaxena/Documents/Junior/Meshworks/Worldsight/meshworks/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\n\n/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { property } from 'lit-element';\nimport { $announceModelVisibility, $ariaLabel, $getLoaded, $getModelIsVisible, $isElementInViewport, $progressTracker, $updateSource, $userInputElement } from '../model-viewer-base.js';\nimport { $loader, CachingGLTFLoader } from '../three-components/CachingGLTFLoader.js';\nimport { ModelViewerGLTFInstance } from '../three-components/gltf-instance/ModelViewerGLTFInstance.js';\nimport { deserializeUrl, throttle } from '../utilities.js';\nimport { LoadingStatusAnnouncer } from './loading/status-announcer.js';\nexport var POSTER_TRANSITION_TIME = 300;\nexport var PROGRESS_BAR_UPDATE_THRESHOLD = 100;\nvar PROGRESS_MASK_BASE_OPACITY = 0.2;\nvar DEFAULT_DRACO_DECODER_LOCATION = 'https://www.gstatic.com/draco/versioned/decoders/1.3.5/';\nvar SPACE_KEY = 32;\nvar ENTER_KEY = 13;\nvar RevealStrategy = {\n  AUTO: 'auto',\n  INTERACTION: 'interaction'\n};\nvar PosterDismissalSource = {\n  INTERACTION: 'interaction'\n};\nvar loader = new CachingGLTFLoader(ModelViewerGLTFInstance);\nvar loadingStatusAnnouncer = new LoadingStatusAnnouncer();\nexport var $defaultProgressBarElement = Symbol('defaultProgressBarElement');\nexport var $defaultProgressMaskElement = Symbol('defaultProgressMaskElement');\nexport var $posterContainerElement = Symbol('posterContainerElement');\nexport var $defaultPosterElement = Symbol('defaultPosterElement');\nvar $posterDismissalSource = Symbol('posterDismissalSource');\nvar $modelIsReadyForReveal = Symbol('modelIsReadyForReveal');\nvar $shouldAttemptPreload = Symbol('shouldAttemptPreload');\nvar $shouldRevealModel = Symbol('shouldRevealModel');\nvar $showPoster = Symbol('showPoster');\nvar $hidePoster = Symbol('hidePoster');\nvar $modelIsRevealed = Symbol('modelIsRevealed');\nvar $preloadAttempted = Symbol('preloadAttempted');\nvar $sourceUpdated = Symbol('sourceUpdated');\nvar $updateLoadingAndVisibility = Symbol('updateLoadingAndVisibility');\nvar $updateProgressBar = Symbol('updateProgressBar');\nvar $lastReportedProgress = Symbol('lastReportedProgress');\nvar $ariaLabelCallToAction = Symbol('ariaLabelCallToAction');\nvar $clickHandler = Symbol('clickHandler');\nvar $keydownHandler = Symbol('keydownHandler');\nvar $progressHandler = Symbol('processHandler');\nvar $onClick = Symbol('onClick');\nvar $onKeydown = Symbol('onKeydown');\nvar $onProgress = Symbol('onProgress');\n/**\n * LoadingMixin implements features related to lazy loading, as well as\n * presentation details related to the pre-load / pre-render presentation of a\n * <model-viewer>\n *\n * This mixin implements support for models with DRACO-compressed meshes.\n * The DRACO decoder will be loaded on-demand if a glTF that uses the DRACO mesh\n * compression extension is encountered.\n *\n * By default, the DRACO decoder will be loaded from a Google CDN. It is\n * possible to customize where the decoder is loaded from by defining a global\n * configuration option for `<model-viewer>` like so:\n *\n * ```html\n * <script>\n * ModelViewerElement = self.ModelViewerElement || {};\n * ModelViewerElement.dracoDecoderLocation =\n *     'http://example.com/location/of/draco/decoder/files/';\n * </script>\n * ```\n *\n * Note that the above configuration strategy must be performed *before* the\n * first `<model-viewer>` element is created in the browser. The configuration\n * can be done anywhere, but the easiest way to ensure it is done at the right\n * time is to do it in the `<head>` of the HTML document. This is the\n * recommended way to set the location because it is most compatible with\n * scenarios where the `<model-viewer>` library is lazily loaded.\n *\n * If you absolutely have to set the DRACO decoder location *after* the first\n * `<model-viewer>` element is created, you can do it this way:\n *\n * ```html\n * <script>\n * const ModelViewerElement = customElements.get('model-viewer');\n * ModelViewerElement.dracoDecoderLocation =\n *     'http://example.com/location/of/draco/decoder/files/';\n * </script>\n * ```\n *\n * Note that the above configuration approach will not work until *after*\n * `<model-viewer>` is defined in the browser. Also note that this configuration\n * *must* be set *before* the first DRACO model is fully loaded.\n *\n * It is recommended that users who intend to take advantage of DRACO mesh\n * compression consider whether or not it is acceptable for their use case to\n * have code side-loaded from a Google CDN. If it is not acceptable, then the\n * location must be customized before loading any DRACO models in order to cause\n * the decoder to be loaded from an alternative, acceptable location.\n */\n\nexport var LoadingMixin = function LoadingMixin(ModelViewerElement) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n\n  var LoadingModelViewerElement = /*#__PURE__*/function (_ModelViewerElement) {\n    _inherits(LoadingModelViewerElement, _ModelViewerElement);\n\n    var _super = _createSuper(LoadingModelViewerElement);\n\n    function LoadingModelViewerElement() {\n      var _this;\n\n      _classCallCheck(this, LoadingModelViewerElement);\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _this = _super.call.apply(_super, [this].concat(args));\n      /**\n       * A URL pointing to the image to use as a poster in scenarios where the\n       * <model-viewer> is not ready to reveal a rendered model to the viewer.\n       */\n\n      _this.poster = null;\n      /**\n       * An enumerable attribute describing under what conditions the\n       * <model-viewer> should reveal a model to the viewer.\n       *\n       * The default value is \"auto\". The only supported alternative value as\n       * of now is \"interaction\".\n       */\n\n      _this.reveal = RevealStrategy.AUTO;\n      /**\n       * If true, a configured model file will be aggressively loaded, even if\n       * the <model-viewer> is only configured to reveal upon interaction.\n       */\n\n      _this.preload = false;\n      _this[_a] = false;\n      _this[_b] = false;\n      _this[_c] = false;\n      _this[_d] = 0;\n      _this[_e] = null; // TODO: Add this to the shadow root as part of this mixin's\n      // implementation:\n\n      _this[_f] = _this.shadowRoot.querySelector('.slot.poster');\n      _this[_g] = _this.shadowRoot.querySelector('#default-poster');\n      _this[_h] = _this.shadowRoot.querySelector('#default-progress-bar > .bar');\n      _this[_j] = _this.shadowRoot.querySelector('#default-progress-bar > .mask');\n      _this[_k] = _this[$defaultPosterElement].getAttribute('aria-label');\n\n      _this[_l] = function () {\n        return _this[$onClick]();\n      };\n\n      _this[_m] = function (event) {\n        return _this[$onKeydown](event);\n      };\n\n      _this[_o] = function (event) {\n        return _this[$onProgress](event);\n      };\n\n      _this[_p] = throttle(function (progress) {\n        var parentNode = _this[$defaultProgressBarElement].parentNode;\n        requestAnimationFrame(function () {\n          _this[$defaultProgressMaskElement].style.opacity = \"\".concat((1.0 - progress) * PROGRESS_MASK_BASE_OPACITY);\n          _this[$defaultProgressBarElement].style.transform = \"scaleX(\".concat(progress, \")\");\n\n          if (progress === 0) {\n            // NOTE(cdata): We remove and re-append the progress bar in this\n            // condition so that the progress bar does not appear to\n            // transition backwards from the right when we reset to 0 (or\n            // otherwise <1) progress after having already reached 1 progress\n            // previously.\n            parentNode.removeChild(_this[$defaultProgressBarElement]);\n            parentNode.appendChild(_this[$defaultProgressBarElement]);\n          } // NOTE(cdata): IE11 does not properly respect the second parameter\n          // of classList.toggle, which this implementation originally used.\n          // @see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11865865/\n\n\n          if (progress === 1.0) {\n            _this[$defaultProgressBarElement].classList.add('hide');\n          } else {\n            _this[$defaultProgressBarElement].classList.remove('hide');\n          }\n        });\n      }, PROGRESS_BAR_UPDATE_THRESHOLD);\n      var ModelViewerElement = self.ModelViewerElement || {};\n      var dracoDecoderLocation = ModelViewerElement.dracoDecoderLocation || DEFAULT_DRACO_DECODER_LOCATION;\n      CachingGLTFLoader.setDRACODecoderLocation(dracoDecoderLocation);\n      return _this;\n    }\n\n    _createClass(LoadingModelViewerElement, [{\n      key: \"dismissPoster\",\n\n      /**\n       * Dismisses the poster, causing the model to load and render if\n       * necessary. This is currently effectively the same as interacting with\n       * the poster via user input.\n       */\n      value: function dismissPoster() {\n        this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n        this.requestUpdate();\n      }\n    }, {\n      key: \"connectedCallback\",\n      value: function connectedCallback() {\n        _get(_getPrototypeOf(LoadingModelViewerElement.prototype), \"connectedCallback\", this).call(this); // Fired when a user first clicks the model element. Used to\n        // change the visibility of a poster image, or start loading\n        // a model.\n\n\n        this[$posterContainerElement].addEventListener('click', this[$clickHandler]);\n        this[$posterContainerElement].addEventListener('keydown', this[$keydownHandler]);\n        this[$progressTracker].addEventListener('progress', this[$progressHandler]);\n        loadingStatusAnnouncer.registerInstance(this);\n      }\n    }, {\n      key: \"disconnectedCallback\",\n      value: function disconnectedCallback() {\n        _get(_getPrototypeOf(LoadingModelViewerElement.prototype), \"disconnectedCallback\", this).call(this);\n\n        this[$posterContainerElement].removeEventListener('click', this[$clickHandler]);\n        this[$posterContainerElement].removeEventListener('keydown', this[$keydownHandler]);\n        this[$progressTracker].removeEventListener('progress', this[$progressHandler]);\n        loadingStatusAnnouncer.unregisterInstance(this);\n      }\n    }, {\n      key: \"updated\",\n      value: function () {\n        var _updated = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(changedProperties) {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  _get(_getPrototypeOf(LoadingModelViewerElement.prototype), \"updated\", this).call(this, changedProperties);\n\n                  if (changedProperties.has('poster') && this.poster != null) {\n                    this[$defaultPosterElement].style.backgroundImage = \"url(\".concat(this.poster, \")\");\n                  }\n\n                  if (changedProperties.has('src')) {\n                    if (!this[$modelIsReadyForReveal]) {\n                      this[$lastReportedProgress] = 0;\n                    }\n\n                    this[$posterDismissalSource] = null;\n                    this[$preloadAttempted] = false;\n                    this[$sourceUpdated] = false;\n                  }\n\n                  if (changedProperties.has('alt')) {\n                    this[$defaultPosterElement].setAttribute('aria-label', \"\".concat(this[$ariaLabel], \". \").concat(this[$ariaLabelCallToAction]));\n                  }\n\n                  this[$updateLoadingAndVisibility]();\n\n                case 5:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n\n        function updated(_x) {\n          return _updated.apply(this, arguments);\n        }\n\n        return updated;\n      }()\n    }, {\n      key: (_a = $modelIsRevealed, _b = $preloadAttempted, _c = $sourceUpdated, _d = $lastReportedProgress, _e = $posterDismissalSource, _f = $posterContainerElement, _g = $defaultPosterElement, _h = $defaultProgressBarElement, _j = $defaultProgressMaskElement, _k = $ariaLabelCallToAction, _l = $clickHandler, _m = $keydownHandler, _o = $progressHandler, _p = $updateProgressBar, $onClick),\n      value: function value() {\n        this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n        this.requestUpdate();\n      }\n    }, {\n      key: $onKeydown,\n      value: function value(event) {\n        switch (event.keyCode) {\n          // NOTE(cdata): Links and buttons can typically be activated with\n          // both spacebar and enter to produce a synthetic click action\n          case SPACE_KEY:\n          case ENTER_KEY:\n            this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n            break;\n\n          default:\n            break;\n        }\n\n        this.requestUpdate();\n      }\n    }, {\n      key: $onProgress,\n      value: function value(event) {\n        var progress = event.detail.totalProgress;\n        this.requestUpdate();\n\n        if (progress === 1.0) {\n          this[$updateProgressBar].flush();\n        }\n\n        this[$updateProgressBar](progress);\n        this.dispatchEvent(new CustomEvent('progress', {\n          detail: {\n            totalProgress: progress\n          }\n        }));\n        this[$lastReportedProgress] = Math.max(progress, this[$lastReportedProgress]);\n      }\n    }, {\n      key: $updateLoadingAndVisibility,\n      value: function () {\n        var _value = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          var updatePreloadProgress, src, detail;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  if (!(this[$shouldAttemptPreload] && !this[$preloadAttempted])) {\n                    _context2.next = 18;\n                    break;\n                  }\n\n                  this[$preloadAttempted] = true;\n                  updatePreloadProgress = this[$progressTracker].beginActivity();\n                  _context2.prev = 3;\n                  src = this.src;\n                  detail = {\n                    url: src\n                  };\n                  _context2.next = 8;\n                  return loader.preload(src, updatePreloadProgress);\n\n                case 8:\n                  this.dispatchEvent(new CustomEvent('preload', {\n                    detail: detail\n                  }));\n                  _context2.next = 14;\n                  break;\n\n                case 11:\n                  _context2.prev = 11;\n                  _context2.t0 = _context2[\"catch\"](3);\n                  this.dispatchEvent(new CustomEvent('error', {\n                    detail: {\n                      type: 'loadfailure',\n                      sourceError: _context2.t0\n                    }\n                  }));\n\n                case 14:\n                  _context2.prev = 14;\n                  updatePreloadProgress(1.0);\n                  this.requestUpdate();\n                  return _context2.finish(14);\n\n                case 18:\n                  if (!this[$modelIsReadyForReveal]) {\n                    _context2.next = 23;\n                    break;\n                  }\n\n                  _context2.next = 21;\n                  return this[$updateSource]();\n\n                case 21:\n                  _context2.next = 24;\n                  break;\n\n                case 23:\n                  this[$showPoster]();\n\n                case 24:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, this, [[3, 11, 14, 18]]);\n        }));\n\n        function value() {\n          return _value.apply(this, arguments);\n        }\n\n        return value;\n      }()\n    }, {\n      key: $showPoster,\n      value: function value() {\n        var _this2 = this;\n\n        var posterContainerElement = this[$posterContainerElement];\n        var defaultPosterElement = this[$defaultPosterElement];\n        var posterContainerOpacity = parseFloat(self.getComputedStyle(posterContainerElement).opacity);\n        defaultPosterElement.removeAttribute('tabindex');\n        defaultPosterElement.removeAttribute('aria-hidden');\n        posterContainerElement.classList.add('show');\n\n        if (posterContainerOpacity < 1.0) {\n          posterContainerElement.addEventListener('transitionend', function () {\n            var oldVisibility = _this2.modelIsVisible;\n            _this2[$modelIsRevealed] = false;\n\n            _this2[$announceModelVisibility](oldVisibility);\n          }, {\n            once: true\n          });\n        }\n      }\n    }, {\n      key: $hidePoster,\n      value: function value() {\n        var _this3 = this;\n\n        var posterContainerElement = this[$posterContainerElement];\n        var defaultPosterElement = this[$defaultPosterElement];\n\n        if (posterContainerElement.classList.contains('show')) {\n          posterContainerElement.classList.remove('show'); // We might need to forward focus to our internal canvas, but that\n          // cannot happen until the poster has completely transitioned away\n\n          posterContainerElement.addEventListener('transitionend', function () {\n            var oldVisibility = _this3.modelIsVisible;\n            requestAnimationFrame(function () {\n              _this3[$modelIsRevealed] = true;\n\n              _this3[$announceModelVisibility](oldVisibility);\n\n              var root = _this3.getRootNode(); // If the <model-viewer> is still focused, forward the focus to\n              // the canvas that has just been revealed\n\n\n              if (root && root.activeElement === _this3) {\n                _this3[$userInputElement].focus();\n              } // Ensure that the poster is no longer focusable or visible to\n              // screen readers\n\n\n              defaultPosterElement.setAttribute('aria-hidden', 'true');\n              defaultPosterElement.tabIndex = -1;\n            });\n          }, {\n            once: true\n          });\n        }\n      }\n    }, {\n      key: $getModelIsVisible,\n      value: function value() {\n        return _get(_getPrototypeOf(LoadingModelViewerElement.prototype), $getModelIsVisible, this).call(this) && this[$modelIsRevealed];\n      }\n    }, {\n      key: $getLoaded,\n      value: function value() {\n        var src = this.src;\n        return _get(_getPrototypeOf(LoadingModelViewerElement.prototype), $getLoaded, this).call(this) || !!(src && CachingGLTFLoader.hasFinishedLoading(src));\n      }\n    }, {\n      key: $updateSource,\n      value: function () {\n        var _value2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n          return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  if (!(this[$modelIsReadyForReveal] && !this[$sourceUpdated])) {\n                    _context3.next = 5;\n                    break;\n                  }\n\n                  this[$sourceUpdated] = true;\n                  _context3.next = 4;\n                  return _get(_getPrototypeOf(LoadingModelViewerElement.prototype), $updateSource, this).call(this);\n\n                case 4:\n                  this[$hidePoster]();\n\n                case 5:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3, this);\n        }));\n\n        function value() {\n          return _value2.apply(this, arguments);\n        }\n\n        return value;\n      }()\n    }, {\n      key: $modelIsReadyForReveal,\n      get: function get() {\n        var src = this.src;\n        return !!src && CachingGLTFLoader.hasFinishedLoading(src) && this[$lastReportedProgress] === 1.0 && this[$shouldRevealModel];\n      }\n    }, {\n      key: $shouldRevealModel,\n      get: function get() {\n        return this.reveal === RevealStrategy.AUTO || !!this[$posterDismissalSource];\n      }\n    }, {\n      key: $shouldAttemptPreload,\n      get: function get() {\n        var src = this.src;\n        return !!src && (this.preload || this[$shouldRevealModel]) && this[$isElementInViewport];\n      }\n    }], [{\n      key: \"mapURLs\",\n\n      /**\n       * If provided, the callback will be passed each resource URL before a\n       * request is sent. The callback may return the original URL, or a new URL\n       * to override loading behavior. This behavior can be used to load assets\n       * from .ZIP files, drag-and-drop APIs, and Data URIs.\n       */\n      value: function mapURLs(callback) {\n        loader[$loader].manager.setURLModifier(callback);\n      }\n    }, {\n      key: \"dracoDecoderLocation\",\n      set: function set(value) {\n        CachingGLTFLoader.setDRACODecoderLocation(value);\n      },\n      get: function get() {\n        return CachingGLTFLoader.getDRACODecoderLocation();\n      }\n    }]);\n\n    return LoadingModelViewerElement;\n  }(ModelViewerElement);\n\n  __decorate([property({\n    converter: {\n      fromAttribute: deserializeUrl\n    }\n  })], LoadingModelViewerElement.prototype, \"poster\", void 0);\n\n  __decorate([property({\n    type: String\n  })], LoadingModelViewerElement.prototype, \"reveal\", void 0);\n\n  __decorate([property({\n    type: Boolean\n  })], LoadingModelViewerElement.prototype, \"preload\", void 0);\n\n  return LoadingModelViewerElement;\n};","map":{"version":3,"sources":["../../src/features/loading.ts"],"names":[],"mappings":"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","sourcesContent":["/* @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {property} from 'lit-element';\n\nimport ModelViewerElementBase, {$announceModelVisibility, $ariaLabel, $getLoaded, $getModelIsVisible, $isElementInViewport, $progressTracker, $updateSource, $userInputElement} from '../model-viewer-base.js';\nimport {$loader, CachingGLTFLoader} from '../three-components/CachingGLTFLoader.js';\nimport {ModelViewerGLTFInstance} from '../three-components/gltf-instance/ModelViewerGLTFInstance.js';\nimport {Constructor, deserializeUrl, throttle} from '../utilities.js';\n\nimport {LoadingStatusAnnouncer} from './loading/status-announcer.js';\n\nexport type RevealAttributeValue = 'auto'|'interaction';\ntype DismissalSource = 'interaction';\n\nexport const POSTER_TRANSITION_TIME = 300;\nexport const PROGRESS_BAR_UPDATE_THRESHOLD = 100;\nconst PROGRESS_MASK_BASE_OPACITY = 0.2;\n\nconst DEFAULT_DRACO_DECODER_LOCATION =\n    'https://www.gstatic.com/draco/versioned/decoders/1.3.5/';\n\nconst SPACE_KEY = 32;\nconst ENTER_KEY = 13;\n\nconst RevealStrategy: {[index: string]: RevealAttributeValue} = {\n  AUTO: 'auto',\n  INTERACTION: 'interaction'\n};\n\nconst PosterDismissalSource: {[index: string]: DismissalSource} = {\n  INTERACTION: 'interaction'\n};\n\nconst loader = new CachingGLTFLoader(ModelViewerGLTFInstance);\nconst loadingStatusAnnouncer = new LoadingStatusAnnouncer();\n\nexport const $defaultProgressBarElement = Symbol('defaultProgressBarElement');\nexport const $defaultProgressMaskElement = Symbol('defaultProgressMaskElement');\n\nexport const $posterContainerElement = Symbol('posterContainerElement');\nexport const $defaultPosterElement = Symbol('defaultPosterElement');\n\nconst $posterDismissalSource = Symbol('posterDismissalSource');\n\nconst $modelIsReadyForReveal = Symbol('modelIsReadyForReveal');\nconst $shouldAttemptPreload = Symbol('shouldAttemptPreload');\nconst $shouldRevealModel = Symbol('shouldRevealModel');\nconst $showPoster = Symbol('showPoster');\nconst $hidePoster = Symbol('hidePoster');\nconst $modelIsRevealed = Symbol('modelIsRevealed');\nconst $preloadAttempted = Symbol('preloadAttempted');\nconst $sourceUpdated = Symbol('sourceUpdated');\n\nconst $updateLoadingAndVisibility = Symbol('updateLoadingAndVisibility');\n\nconst $updateProgressBar = Symbol('updateProgressBar');\nconst $lastReportedProgress = Symbol('lastReportedProgress');\n\nconst $ariaLabelCallToAction = Symbol('ariaLabelCallToAction');\n\nconst $clickHandler = Symbol('clickHandler');\nconst $keydownHandler = Symbol('keydownHandler');\nconst $progressHandler = Symbol('processHandler');\nconst $onClick = Symbol('onClick');\nconst $onKeydown = Symbol('onKeydown');\nconst $onProgress = Symbol('onProgress');\n\nexport declare interface LoadingInterface {\n  poster: string|null;\n  reveal: RevealAttributeValue;\n  preload: boolean;\n  readonly loaded: boolean;\n  readonly modelIsVisible: boolean;\n  dismissPoster(): void;\n}\n\nexport declare interface LoadingStaticInterface {\n  dracoDecoderLocation: string;\n  mapURLs(callback: (url: string) => string): void;\n}\n\ninterface ModelViewerGlobalConfig {\n  dracoDecoderLocation?: string;\n}\n\n/**\n * LoadingMixin implements features related to lazy loading, as well as\n * presentation details related to the pre-load / pre-render presentation of a\n * <model-viewer>\n *\n * This mixin implements support for models with DRACO-compressed meshes.\n * The DRACO decoder will be loaded on-demand if a glTF that uses the DRACO mesh\n * compression extension is encountered.\n *\n * By default, the DRACO decoder will be loaded from a Google CDN. It is\n * possible to customize where the decoder is loaded from by defining a global\n * configuration option for `<model-viewer>` like so:\n *\n * ```html\n * <script>\n * ModelViewerElement = self.ModelViewerElement || {};\n * ModelViewerElement.dracoDecoderLocation =\n *     'http://example.com/location/of/draco/decoder/files/';\n * </script>\n * ```\n *\n * Note that the above configuration strategy must be performed *before* the\n * first `<model-viewer>` element is created in the browser. The configuration\n * can be done anywhere, but the easiest way to ensure it is done at the right\n * time is to do it in the `<head>` of the HTML document. This is the\n * recommended way to set the location because it is most compatible with\n * scenarios where the `<model-viewer>` library is lazily loaded.\n *\n * If you absolutely have to set the DRACO decoder location *after* the first\n * `<model-viewer>` element is created, you can do it this way:\n *\n * ```html\n * <script>\n * const ModelViewerElement = customElements.get('model-viewer');\n * ModelViewerElement.dracoDecoderLocation =\n *     'http://example.com/location/of/draco/decoder/files/';\n * </script>\n * ```\n *\n * Note that the above configuration approach will not work until *after*\n * `<model-viewer>` is defined in the browser. Also note that this configuration\n * *must* be set *before* the first DRACO model is fully loaded.\n *\n * It is recommended that users who intend to take advantage of DRACO mesh\n * compression consider whether or not it is acceptable for their use case to\n * have code side-loaded from a Google CDN. If it is not acceptable, then the\n * location must be customized before loading any DRACO models in order to cause\n * the decoder to be loaded from an alternative, acceptable location.\n */\nexport const LoadingMixin = <T extends Constructor<ModelViewerElementBase>>(\n    ModelViewerElement:\n        T): Constructor<LoadingInterface, LoadingStaticInterface>&T => {\n  class LoadingModelViewerElement extends ModelViewerElement {\n    static set dracoDecoderLocation(value: string) {\n      CachingGLTFLoader.setDRACODecoderLocation(value);\n    }\n\n    static get dracoDecoderLocation() {\n      return CachingGLTFLoader.getDRACODecoderLocation();\n    }\n\n    /**\n     * If provided, the callback will be passed each resource URL before a\n     * request is sent. The callback may return the original URL, or a new URL\n     * to override loading behavior. This behavior can be used to load assets\n     * from .ZIP files, drag-and-drop APIs, and Data URIs.\n     */\n    static mapURLs(callback: (url: string) => string) {\n      loader[$loader].manager.setURLModifier(callback);\n    }\n\n    /**\n     * A URL pointing to the image to use as a poster in scenarios where the\n     * <model-viewer> is not ready to reveal a rendered model to the viewer.\n     */\n    @property({converter: {fromAttribute: deserializeUrl}})\n    poster: string|null = null;\n\n    /**\n     * An enumerable attribute describing under what conditions the\n     * <model-viewer> should reveal a model to the viewer.\n     *\n     * The default value is \"auto\". The only supported alternative value as\n     * of now is \"interaction\".\n     */\n    @property({type: String})\n    reveal: RevealAttributeValue = RevealStrategy.AUTO;\n\n    /**\n     * If true, a configured model file will be aggressively loaded, even if\n     * the <model-viewer> is only configured to reveal upon interaction.\n     */\n    @property({type: Boolean}) preload: boolean = false;\n\n    /**\n     * Dismisses the poster, causing the model to load and render if\n     * necessary. This is currently effectively the same as interacting with\n     * the poster via user input.\n     */\n    dismissPoster() {\n      this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n      this.requestUpdate();\n    }\n\n    protected[$modelIsRevealed] = false;\n    protected[$preloadAttempted] = false;\n    protected[$sourceUpdated] = false;\n\n    protected[$lastReportedProgress]: number = 0;\n\n    protected[$posterDismissalSource]: DismissalSource|null = null;\n\n    // TODO: Add this to the shadow root as part of this mixin's\n    // implementation:\n    protected[$posterContainerElement]: HTMLElement =\n        this.shadowRoot!.querySelector('.slot.poster') as HTMLElement;\n\n    protected[$defaultPosterElement]: HTMLElement =\n        this.shadowRoot!.querySelector('#default-poster') as HTMLElement;\n\n    protected[$defaultProgressBarElement]: HTMLElement =\n        this.shadowRoot!.querySelector('#default-progress-bar > .bar') as\n        HTMLElement;\n\n    protected[$defaultProgressMaskElement]: HTMLElement =\n        this.shadowRoot!.querySelector('#default-progress-bar > .mask') as\n        HTMLElement;\n\n    protected[$ariaLabelCallToAction] =\n        this[$defaultPosterElement].getAttribute('aria-label');\n\n    protected[$clickHandler]: () => void = () => this[$onClick]();\n    protected[$keydownHandler]:\n        (event: KeyboardEvent) => void = (event) => this[$onKeydown](event);\n    protected[$progressHandler]:\n        (event: Event) => void = (event) => this[$onProgress](event);\n\n    protected[$updateProgressBar] = throttle((progress: number) => {\n      const parentNode = this[$defaultProgressBarElement].parentNode as Element;\n\n      requestAnimationFrame(() => {\n        this[$defaultProgressMaskElement].style.opacity =\n            `${(1.0 - progress) * PROGRESS_MASK_BASE_OPACITY}`;\n\n        this[$defaultProgressBarElement].style.transform =\n            `scaleX(${progress})`;\n\n        if (progress === 0) {\n          // NOTE(cdata): We remove and re-append the progress bar in this\n          // condition so that the progress bar does not appear to\n          // transition backwards from the right when we reset to 0 (or\n          // otherwise <1) progress after having already reached 1 progress\n          // previously.\n          parentNode.removeChild(this[$defaultProgressBarElement]);\n          parentNode.appendChild(this[$defaultProgressBarElement]);\n        }\n\n        // NOTE(cdata): IE11 does not properly respect the second parameter\n        // of classList.toggle, which this implementation originally used.\n        // @see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11865865/\n        if (progress === 1.0) {\n          this[$defaultProgressBarElement].classList.add('hide');\n        } else {\n          this[$defaultProgressBarElement].classList.remove('hide');\n        }\n      });\n    }, PROGRESS_BAR_UPDATE_THRESHOLD);\n\n    constructor(...args: Array<any>) {\n      super(...args);\n\n      const ModelViewerElement: ModelViewerGlobalConfig =\n          (self as any).ModelViewerElement || {};\n      const dracoDecoderLocation = ModelViewerElement.dracoDecoderLocation ||\n          DEFAULT_DRACO_DECODER_LOCATION;\n\n      CachingGLTFLoader.setDRACODecoderLocation(dracoDecoderLocation);\n    }\n\n    connectedCallback() {\n      super.connectedCallback();\n\n      // Fired when a user first clicks the model element. Used to\n      // change the visibility of a poster image, or start loading\n      // a model.\n      this[$posterContainerElement].addEventListener(\n          'click', this[$clickHandler]);\n      this[$posterContainerElement].addEventListener(\n          'keydown', this[$keydownHandler]);\n      this[$progressTracker].addEventListener(\n          'progress', this[$progressHandler]);\n\n      loadingStatusAnnouncer.registerInstance(this);\n    }\n\n    disconnectedCallback() {\n      super.disconnectedCallback();\n\n      this[$posterContainerElement].removeEventListener(\n          'click', this[$clickHandler]);\n      this[$posterContainerElement].removeEventListener(\n          'keydown', this[$keydownHandler]);\n      this[$progressTracker].removeEventListener(\n          'progress', this[$progressHandler]);\n\n      loadingStatusAnnouncer.unregisterInstance(this)\n    }\n\n    async updated(changedProperties: Map<string, any>) {\n      super.updated(changedProperties);\n\n      if (changedProperties.has('poster') && this.poster != null) {\n        this[$defaultPosterElement].style.backgroundImage =\n            `url(${this.poster})`;\n      }\n\n      if (changedProperties.has('src')) {\n        if (!this[$modelIsReadyForReveal]) {\n          this[$lastReportedProgress] = 0;\n        }\n\n        this[$posterDismissalSource] = null;\n        this[$preloadAttempted] = false;\n        this[$sourceUpdated] = false;\n      }\n\n      if (changedProperties.has('alt')) {\n        this[$defaultPosterElement].setAttribute(\n            'aria-label',\n            `${this[$ariaLabel]}. ${this[$ariaLabelCallToAction]}`);\n      }\n\n      this[$updateLoadingAndVisibility]()\n    }\n\n    [$onClick]() {\n      this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n      this.requestUpdate();\n    }\n\n    [$onKeydown](event: KeyboardEvent) {\n      switch (event.keyCode) {\n        // NOTE(cdata): Links and buttons can typically be activated with\n        // both spacebar and enter to produce a synthetic click action\n        case SPACE_KEY:\n        case ENTER_KEY:\n          this[$posterDismissalSource] = PosterDismissalSource.INTERACTION;\n          break;\n        default:\n          break;\n      }\n\n      this.requestUpdate();\n    }\n\n    [$onProgress](event: Event) {\n      const progress = (event as any).detail.totalProgress;\n\n      this.requestUpdate();\n\n      if (progress === 1.0) {\n        this[$updateProgressBar].flush();\n      }\n\n      this[$updateProgressBar](progress);\n\n      this.dispatchEvent(\n          new CustomEvent('progress', {detail: {totalProgress: progress}}));\n\n      this[$lastReportedProgress] =\n          Math.max(progress, this[$lastReportedProgress]);\n    }\n\n    get[$modelIsReadyForReveal](): boolean {\n      const {src} = this;\n\n      return !!src && CachingGLTFLoader.hasFinishedLoading(src) &&\n          this[$lastReportedProgress] === 1.0 && this[$shouldRevealModel]\n    }\n\n    get[$shouldRevealModel](): boolean {\n      return this.reveal === RevealStrategy.AUTO ||\n          !!this[$posterDismissalSource];\n    }\n\n    get[$shouldAttemptPreload](): boolean {\n      const {src} = this;\n\n      return !!src && (this.preload || this[$shouldRevealModel]) &&\n          this[$isElementInViewport];\n    }\n\n    async[$updateLoadingAndVisibility]() {\n      if (this[$shouldAttemptPreload] && !this[$preloadAttempted]) {\n        this[$preloadAttempted] = true;\n\n        const updatePreloadProgress = this[$progressTracker].beginActivity();\n\n        try {\n          const src = this.src!;\n          const detail = {url: src};\n\n          await loader.preload(src, updatePreloadProgress);\n          this.dispatchEvent(new CustomEvent('preload', {detail}));\n        } catch (error) {\n          this.dispatchEvent(new CustomEvent(\n              'error', {detail: {type: 'loadfailure', sourceError: error}}));\n        } finally {\n          updatePreloadProgress(1.0);\n          this.requestUpdate();\n        }\n      }\n\n      if (this[$modelIsReadyForReveal]) {\n        await this[$updateSource]();\n      } else {\n        this[$showPoster]();\n      }\n    }\n\n    [$showPoster]() {\n      const posterContainerElement = this[$posterContainerElement];\n      const defaultPosterElement = this[$defaultPosterElement];\n      const posterContainerOpacity =\n          parseFloat(self.getComputedStyle(posterContainerElement).opacity!);\n\n      defaultPosterElement.removeAttribute('tabindex');\n      defaultPosterElement.removeAttribute('aria-hidden');\n      posterContainerElement.classList.add('show');\n\n      if (posterContainerOpacity < 1.0) {\n        posterContainerElement.addEventListener('transitionend', () => {\n          const oldVisibility = this.modelIsVisible;\n          this[$modelIsRevealed] = false;\n          this[$announceModelVisibility](oldVisibility);\n        }, {once: true});\n      }\n    }\n\n    [$hidePoster]() {\n      const posterContainerElement = this[$posterContainerElement];\n      const defaultPosterElement = this[$defaultPosterElement];\n\n      if (posterContainerElement.classList.contains('show')) {\n        posterContainerElement.classList.remove('show');\n\n        // We might need to forward focus to our internal canvas, but that\n        // cannot happen until the poster has completely transitioned away\n        posterContainerElement.addEventListener('transitionend', () => {\n          const oldVisibility = this.modelIsVisible;\n          requestAnimationFrame(() => {\n            this[$modelIsRevealed] = true;\n            this[$announceModelVisibility](oldVisibility);\n\n            const root = this.getRootNode();\n\n            // If the <model-viewer> is still focused, forward the focus to\n            // the canvas that has just been revealed\n            if (root &&\n                (root as Document | ShadowRoot).activeElement === this) {\n              this[$userInputElement].focus();\n            }\n\n            // Ensure that the poster is no longer focusable or visible to\n            // screen readers\n            defaultPosterElement.setAttribute('aria-hidden', 'true');\n            defaultPosterElement.tabIndex = -1;\n          });\n        }, {once: true});\n      }\n    }\n\n    [$getModelIsVisible]() {\n      return super[$getModelIsVisible]() && this[$modelIsRevealed];\n    }\n\n    [$getLoaded]() {\n      const src = this.src;\n      return super[$getLoaded]() ||\n          !!(src && CachingGLTFLoader.hasFinishedLoading(src));\n    }\n\n    async[$updateSource]() {\n      if (this[$modelIsReadyForReveal] && !this[$sourceUpdated]) {\n        this[$sourceUpdated] = true;\n        await super[$updateSource]();\n        this[$hidePoster]();\n      }\n    }\n  }\n\n  return LoadingModelViewerElement;\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}